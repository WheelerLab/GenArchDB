filenameIn <-"WholeBlood_TW_exp_BSLMM-s100K_iterations_all_chr1-22_2015-10-18.txt"
tissue_type <- strsplit(filenameIn,"_" )
tissu_type[1]
tissue_type[1]
tissue_type[[1]][1]
tissue_type<-paste(tissue_type[[1]][1:2], sep="")
head(tissue_type)
head(tissue_type)
tissue_type <- strsplit(filenameIn,"_" )
tissue_type<-paste(tissue_type[[1]][1],tissue_tpye[[1]][2] sep="")
tissue_type <- strsplit(filenameIn,"_" )
tissue_type<-paste(tissue_type[[1]][1],tissue_tpye[[1]][2], sep="_")
filenameIn <-"WholeBlood_TW_exp_BSLMM-s100K_iterations_all_chr1-22_2015-10-18.txt"
filenameIn,"
tissue_type <- strsplit(filenameIn,"_" )
tissue_type <- strsplit(filenameIn)
filenameIn <-"WholeBlood_TW_exp_BSLMM-s100K_iterations_all_chr1-22_2015-10-18.txt"
tissue_type <- strsplit(filenameIn)
filenameIn <-"WholeBlood_TW_exp_BSLMM-s100K_iterations_all_chr1-22_2015-10-18.txt"
tissue_type <- strsplit(filenameIn,"_" )
tissue_type<-paste(tissue_type[[1]][1],tissue_tye[[1]][2], sep="_")
tissue_type<-paste(tissue_type[[1]][1],tissue_type[[1]][2], sep="_")
head(tissue_type)
args<-commandArgs(trailingOnly=T)
filenameIn<-as.character(args[1])
#filenameIn <-"WholeBlood_TW_exp_BSLMM-s100K_iterations_all_chr1-22_2015-10-18.txt"
tissue_type <- strsplit(filenameIn,"_" )
tissue_type<-paste(tissue_type[[1]][1],tissue_type[[1]][2], sep="_")
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[-c(2,4,6,7,8,10,12,13,14,16,18,19)]
dataOut<-data[-c(2,4,6,7,8,10,12,13,14,16,18,19)]
filenameIn <-"WholeBlood_TW_exp_BSLMM-s100K_iterations_all_chr1-22_2015-10-18.txt"
tissue_type <- strsplit(filenameIn,"_" )
tissue_type<-paste(tissue_type[[1]][1],tissue_type[[1]][2], sep="_")
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[-c(2,4,6,7,8,10,12,13,14,16,18,19)]
dataOut <- cbind(dataOut,tissue_type= tissue_type)
head(dataOut)
dataOut <- cbind(dataOut,tissue_type= tissue_type, pve_CI = paste(dataOut$pve025,dataOut$pge975,sep="_"))
head(dataOut)
dataOut <- cbind(dataOut,tissue_type= tissue_type, pve_CI = paste(dataOut$pve025,dataOut$pve975,sep="-"), pge_CI = paste(dataOut$pge025,dataOut$pge975,sep="-"))
head(dataOut)
dataOut<-dataOut[-c(dataOut$pve025,dataOut$pve975,dataOut$pge025,dataOut$pge975)]
dataOut<-dataOut[-c(4:7)]
head(dataOut)
dataOut <- cbind(dataOut,tissue_typ= tissue_type, pve_CI = paste(dataOut$pve025,dataOut$pve975,sep="-"), pge_CI = paste(dataOut$pge025,dataOut$pge975,sep="-"))
dataOut <- cbind(dataOut,tissue_typ= tissue_type, pve_CI = paste(dataOut$pve025,dataOut$pve975,sep="-"), pge_CI = paste(dataOut$pge025,dataOut$pge975,sep="-"))
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[-c(2,4,6,7,8,10,12,13,14,16,18,19)]
dataOut <- cbind(dataOut,tissue_typ= tissue_type, pve_CI = paste(dataOut$pve025,dataOut$pve975,sep="-"), pge_CI = paste(dataOut$pge025,dataOut$pge975,sep="-"))
dataOut<-dataOut[-c(4:7)]
head(dataOut)
tissue <- strsplit(filenameIn,"_" )
tissue <- strsplit(filenameIn,"_" )
tissue<-paste(tissue[[1]][1],tissue[[1]][2], sep="_")
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[-c(2,4,6,7,8,10,12,13,14,16,18,19)]
dataOut <- cbind(dataOut,tissue_type= tissue, pve_CI = paste(dataOut$pve025,dataOut$pve975,sep="-"), pge_CI = paste(dataOut$pge025,dataOut$pge975,sep="-"))
dataOut<-dataOut[-c(4:7)]
head(dataOut)
head data
head(data)
head(dataOut)
T
T
T
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
h2_list<-vector()
data<-read.table(filenameIn, sep='\t', header=TRUE)
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
dataOut<-data[1:2]
i<-3
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
head(ci)
head(ci[1])
ci <-cbind(h2_ci=paste(ci[1], ci[2], sep ="-"))
head(ci)
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
i<-3
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
ci[[1]]
head(ci[[i]])
head(ci[[1]])
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
head(ci)
ci <-cbind(h2_ci=paste(ci[[1]], ci][2]], sep ="-"))
ci <-cbind(h2_ci=paste(ci[[1]], ci[[2]], sep ="-"))
head(ci)
}
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
for( i in 3:21){
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
ci <-cbind(h2_ci=paste(ci[[1]], ci[[2]], sep ="-"))
dataOut<-cbind(dataOut,data[1])
dataOut<-cbind(dataOut,ci)
}
head(dataOut)
source('~/Desktop/GenArchDB/Scripts/DataPrep/GTeX_h2Parser.R', echo=TRUE)
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
for( i in 3:21){
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
ci <-cbind(h2_ci=paste(ci[[1]], ci[[2]], sep ="-"))
dataOut<-cbind(dataOut,data[i])
dataOut<-cbind(dataOut,ci)
}
head(dataOut)
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
for( i in 3:21, by =2){
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
ci <-cbind(h2_ci=paste(ci[[1]], ci[[2]], sep ="-"))
dataOut<-cbind(dataOut,data[i])
dataOut<-cbind(dataOut,ci)
}
head(dataOut)
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
for( i in 3:21 by =2){
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
ci <-cbind(h2_ci=paste(ci[[1]], ci[[2]], sep ="-"))
dataOut<-cbind(dataOut,data[i])
dataOut<-cbind(dataOut,ci)
}
head(dataOut)
args<-commandArgs(trailingOnly=T)
#filenameIn<-as.character(args[1])
filenameIn<-"GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
data<-read.table(filenameIn, sep='\t', header=TRUE)
dataOut<-data[1:2]
for( i in seq(from=3,to=21, by =2)){
ci <- cbind((data[i]-data[i+1]),(data[i]+data[i+1]))
ci <-cbind(h2_ci=paste(ci[[1]], ci[[2]], sep ="-"))
dataOut<-cbind(dataOut,data[i])
dataOut<-cbind(dataOut,ci)
}
head(dataOut)
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
tissue <- grep("/^[A-Za-z0-9]+(?:-[A-Za-z0-9]+)*$/", colnames(blsmm))
tissue
tissue <- grep("//.+?(?=_)/", colnames(blsmm))
tissue <- sub("_", colnames(blsmm$tissue_type))
tissue <- gsub("[^_]*", colnames(blsmm$tissue_type))
tissue <- grep("[^_]*", colnames(blsmm$tissue_type))
tissue
help(grep)
tissue <- grep("[^_]*", value=TRUE,colnames(blsmm$tissue_type))
tissue <- grep("[^_]*", value=TRUE,colnames(blsmm$tissue_type))
colnames()
tissue
tissue <- grep("[^_]*", value=TRUE,"tissue_type")
tissue
tissue <- grep("[^_]", value=TRUE,"tissue_type")
tissue <- grep("[^_]", value=TRUE,"tissue_type")
tissue
tissue <- grep(".+?[^_]", value=TRUE,"tissue_type")
tissue
blsmm$tissue_type[1]
blsmm$tissue_type[[1]][1]
tissue <- bslmmIn[[1]][1]
tissue <- bslmm[[1]][1]
tissue <- blsmm[[1]][1]
tissue <- blsmm$tissue_type[[1]][1]
tissue <- blsmm$tissue_type[1]
tissue
tissue <- as.character(blsmm$tissue_type[1])
tissue
split.str(tissue)
strsplit(tissue,"_")
strsplit(tissue,"_")[1]
as.char(strsplit(tissue,"_")[1])
as.character(strsplit(tissue,"_")[1])
as.character(strsplit(tissue,"_")[[1]][1])
paste(tissue, collapse="-")
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[1])
tissue
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue
paste(tissue, collapse='-')
help("paste")
paste(strsplit(tissue,"-"))
a<-strsplit(tissue,"-")
a
paste(a)
c<-paste(a, collapse="")
c
paste(a[1:])
a[1]
a[[1]]
a[[1]][1:]
a[[1]][1]
a[[1]][1:]
paste(a[[1]])
c=paste(a[[1]])
c
cc<-paste(c)
cc
help(c)
paste(c, collapse="")
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
#grep(".+?[^_]", value=TRUE,"tissue_type")
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue<-strsplit(tissue,'-')
tissue
tisse<-paste(tissue,collapse="")
tissue
c<vector("a","b")
c<c("a","b")
c<_c("a","b")
c<-c("a","b")
c
grep("a",c)
d<-c("a.b","c")
grep(a,d)
pmatch(a,d)
pmatch("a"",d)
""
pmatch("a",d)
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
#grep(".+?[^_]", value=TRUE,"tissue_type")
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue<-strsplit(tissue,'-')
tisse<-paste(tissue,collapse="")
h2Col<-pmatch(tissue, colnames(ht))
h2Col<-pmatch(tissue, colnames(h2))
h2Col
colnames(h2)
tissue
tisse<-paste(tissue[[1]],collapse="")
h2Col<-pmatch(tissue, colnames(h2))
tissue
tissue<-as.character(paste(tissue[[1]],collapse=""))
tissue
h2Col<-pmatch(tissue, colnames(h2))
htCol
h2Col
tissue
colanmes(h2)
colnames(h2)
colnames(h2)[1]
pmatch(tissue,colnames(h2))
tissue
grep(tissue,colnames(h2))
colnames(h2)[5]
head(h2)
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue<-strsplit(tissue,'-')
tissue<-as.character(paste(tissue[[1]],collapse=""))
h2Col<-grep(tissue,colnames(h2)) #get h2 col for specific tissue
h2<-cbind(h2[1:2],h2[h2Col:(h2Col+1)]) # remove other tissues from h2
head(h2)
colnames(blsmm)
colnames(enet)
head(enet)
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue<-strsplit(tissue,'-')
tissue<-as.character(paste(tissue[[1]],collapse=""))
h2Col<-grep(tissue,colnames(h2)) #get h2 col for specific tissue
h2<-cbind(h2[1:2],h2[h2Col:(h2Col+1)]) # remove other tissues from h2
dataOut<-merge(blsmm, h2, by.x="ensid", by.y="ensid")
dataOut<-merge(dataOut,enet, by.x="gene",by.y="gene")
head(dataOut)
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue<-strsplit(tissue,'-')
tissue<-as.character(paste(tissue[[1]],collapse=""))
h2Col<-grep(tissue,colnames(h2)) #get h2 col for specific tissue
h2<-cbind(h2[1:2],h2[h2Col:(h2Col+1)]) # remove other tissues from h2
dataOut<-merge(blsmm, h2, by.x="ensid", by.y="ensid")
colnames(h2)
dataOut<-merge(blsmm, h2, by.x="ensid", by.y="EnsemblGeneID")
dataOut<-merge(dataOut,enet, by.x="gene",by.y="gene")
colnames(dataOut)
cikbanes(enet)
colnames(enet)
dataOut<-merge(dataOut,enet, by.x="AssociatedGeneName",by.y="gene")
head(dataOut)
colnames(dataOut)
dataOut <- cbind(dataOut[1],dataOut[8],dataOut[7],dataOut[4],dataOut[9],dataOut[10],dataOut[2],dataOut[5],dataOut[3],dataOut[6],dataOut[11])
dataOut <- cbind(dataOut[1],dataOut[2],dataOut[5],dataOut[8],dataOut[9],dataOut[3],dataOut[6],dataOut[4],dataOut[7],dataOut[3],dataOut[6],dataOut[10])
head(dataOut)
dataOut(colnames)
colnames(dataOut)
dataOut <- cbind(dataOut[1],dataOut[2],dataOut[5],dataOut[8],dataOut[9],dataOut[3],dataOut[6],dataOut[4],dataOut[7],dataOut[10])
colnames(dataOut)
dataOut <- cbind(dataOut[1],dataOut[2],dataOut[5],dataOut[8],dataOut[9],dataOut[3],dataOut[6],dataOut[4],dataOut[7],dataOut[12])
dataOut <- cbind(dataOut[1],dataOut[2],dataOut[5],dataOut[8],dataOut[9],dataOut[3],dataOut[6],dataOut[4],dataOut[7],dataOut[10])
colnames(dataOut)
args<-commandArgs(trailingOnly=T)
bslmmIn<-as.character(args[1])
enetIn<-as.character(args[2])
h2In<-as.character(args[3])
enetIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB-TS_Adipose-Subcutaneous_exp_10-foldCV_elasticNet_alpha0.5_hapmapSnpsCEU_all_chr1-22_2015-08-27.txt"
h2In<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_GTEx_Tissue-Specific_local_h2_se_geneinfo_no_description.txt"
bslmmIn<-"/home/brenner/Desktop/GenArchDB/Scripts/DataPrep/GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
blsmm<-read.table(bslmmIn, sep='\t', header=TRUE)
colnames(blsmm)[1] = 'ensid' #for GTeX only
head(blsmm)
enet<-read.table(enetIn, sep='\t', header=TRUE)
head(enet)
h2<-read.table(h2In, sep='\t', header=TRUE)
head(h2)
tissue <- as.character(blsmm$tissue_type[1])
tissue<-as.character(strsplit(tissue,"_")[[1]][1])
tissue<-strsplit(tissue,'-')
tissue<-as.character(paste(tissue[[1]],collapse=""))
h2Col<-grep(tissue,colnames(h2)) #get h2 col for specific tissue
h2<-cbind(h2[1:2],h2[h2Col:(h2Col+1)]) # remove other tissues from h2
dataOut<-merge(blsmm, h2, by.x="ensid", by.y="EnsemblGeneID")
dataOut<-merge(dataOut,enet, by.x="AssociatedGeneName",by.y="gene")
colnames(dataOut)
dataOut <- cbind(dataOut[1],dataOut[2],dataOut[5],dataOut[8],dataOut[9],dataOut[3],dataOut[6],dataOut[4],dataOut[7],dataOut[10])
colnames(dataOut)
head(dataOut)
filenameOut<-paste("GenArchTable-",bslmmIn, sep="")
results<-file(filenameOut, "w")
write.table(dataOut,  results, append=FALSE, quote=TRUE, sep=",", row.names=FALSE,col.names=FALSE)
filenameOut<-paste("GenArchTable-",bslmmIn, sep="")
results<-file(filenameOut, "w")
write.table(dataOut,  results, append=FALSE, quote=TRUE, sep=",", row.names=FALSE,col.names=FALSE)
close(results)
bslmmIn<-"GenArchDB_Adipose-Subcutaneous_TS_exp_BSLMM-s100K_iterations_all_chr1-22_2015-08-06.txt"
filenameOut<-paste("GenArchTable-",bslmmIn, sep="")
results<-file(filenameOut, "w")
write.table(dataOut,  results, append=FALSE, quote=TRUE, sep=",", row.names=FALSE,col.names=FALSE)
close(results)
